<!DOCTYPE html>
<html>
<head>
<title>QwikServe Order</title>

<style>

*{box-sizing:border-box;}

body{
margin:0;
font-family:'Poppins',sans-serif;
background:#c59552;
}

/* NAVBAR */

.nav{
background:#3a2e0c;
color:#fff;
padding:15px 30px;
font-size:22px;
font-weight:bold;
display:flex;
justify-content:space-between;
align-items:center;
}

.cart-badge{
background:#d1b865;
color:#000;
padding:5px 10px;
border-radius:50px;
font-size:14px;
}

/* LAYOUT */

.container{
display:flex;
padding:20px;
gap:20px;
}

/* MENU GRID */

.menu{
flex:2;
display:grid;
grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
gap:20px;
}

/* MENU CARD */

.card{
position:relative;
height:220px;
border-radius:20px;
overflow:hidden;
cursor:pointer;
transition:.3s;
box-shadow:0 10px 25px rgba(0,0,0,.2);
}

.card:hover{
transform:scale(1.05);
}

.card img{
width:100%;
height:100%;
object-fit:cover;
}

.overlay{
position:absolute;
bottom:0;
width:100%;
background:linear-gradient(to top,rgba(0,0,0,.8),transparent);
color:white;
padding:10px;
}

.qty-box{
display:flex;
margin-top:5px;
}

.qty-box button{
flex:1;
border:none;
background:#d1b865;
cursor:pointer;
font-size:18px;
}

.qty-box input{
width:40px;
text-align:center;
border:none;
}

/* CART PANEL */

.cart{
flex:1;
background:#3a2e0c;
border-radius:20px;
padding:15px;
height:90vh;
overflow-y:auto;
position:sticky;
top:10px;
color:white;
}

.cart-item{
background:#4a3514;
padding:10px;
margin-bottom:10px;
border-radius:10px;
}

.cart-item button{
width:100%;
padding:5px;
margin-top:5px;
background:#8b0000;
border:none;
color:white;
border-radius:5px;
cursor:pointer;
}

.checkout{
position:sticky;
bottom:0;
background:#3a2e0c;
padding:10px;
}

.checkout button{
width:100%;
padding:10px;
background:#d1b865;
border:none;
border-radius:10px;
font-weight:bold;
cursor:pointer;
margin-top:5px;
}

.out-stock{
color:red;
font-weight:bold;
}

</style>
</head>

<body>

<div class="nav">
QwikServe
<span class="cart-badge" id="itemCount">0 Items</span>
</div>

<div class="container">

<div class="menu" id="menuContainer"></div>

<div class="cart">
<h3>Your Cart</h3>
<div id="cartItems"></div>

<div class="checkout">
<p id="grandTotal"></p>
<button onclick="placeOrder()">Place Order</button>
</div>

</div>

</div>

<script>

/* LOAD MENU */

function loadMenu(){

let menuItems = JSON.parse(localStorage.getItem("menuItems")) || [];
let container = document.getElementById("menuContainer");

container.innerHTML="";

menuItems.forEach((item,i)=>{

container.innerHTML+=`

<div class="card" style="${item.stock===false?'opacity:0.5;':''}">
<img src="${item.image}">
<div class="overlay">

<h4>${item.name}</h4>
<p>₹ ${item.price}</p>

${item.stock===false?

`<p class="out-stock">Out of Stock</p>`

:

`
<div class="qty-box">
<button onclick="dec(${i})">-</button>
<input id="qty${i}" value="1">
<button onclick="inc(${i})">+</button>
</div>

<button onclick="addToCart(${i})">Add</button>
`

}

</div>
</div>

`;

});

}

/* QTY */

function inc(i){
let q=document.getElementById("qty"+i);
q.value=parseInt(q.value)+1;
}

function dec(i){
let q=document.getElementById("qty"+i);
if(q.value>1)q.value--;
}

/* ADD CART */

function addToCart(i){

let menuItems=JSON.parse(localStorage.getItem("menuItems"));
let item=menuItems[i];

if(item.stock===false){
alert("Item is Out of Stock!");
return;
}

let qty=document.getElementById("qty"+i).value;
let cart=JSON.parse(localStorage.getItem("cart"))||[];

cart.push({
name:item.name,
price:item.price,
quantity:parseInt(qty),
total:item.price*qty
});

localStorage.setItem("cart",JSON.stringify(cart));
loadCart();

}

/* LOAD CART */

function loadCart(){

let cart=JSON.parse(localStorage.getItem("cart"))||[];
let c=document.getElementById("cartItems");

let total=0;
let items=0;

c.innerHTML="";

cart.forEach((it,i)=>{

items+=it.quantity;
total+=it.total;

c.innerHTML+=`

<div class="cart-item">
<h4>${it.name}</h4>
<p>${it.quantity} x ₹${it.price}</p>
<p>₹ ${it.total}</p>
<button onclick="removeItem(${i})">Remove</button>
</div>

`;

});

document.getElementById("itemCount").innerText=items+" Items";
document.getElementById("grandTotal").innerText="Total: ₹ "+total;

}

/* REMOVE */

function removeItem(i){
let cart=JSON.parse(localStorage.getItem("cart"))||[];
cart.splice(i,1);
localStorage.setItem("cart",JSON.stringify(cart));
loadCart();
}

/* PLACE ORDER */

function placeOrder(){

let cart = JSON.parse(localStorage.getItem("cart")) || [];

if(cart.length === 0){
alert("Cart is Empty!");
return;
}

let orders = JSON.parse(localStorage.getItem("orders")) || [];

let newOrder = {
orderId: "ORD" + Date.now(),
items: cart,
date: new Date().toLocaleString(),
status:"Preparing"
};

orders.push(newOrder);

localStorage.setItem("orders", JSON.stringify(orders));

/* SAVE LATEST ORDER */
localStorage.setItem("latestOrder", JSON.stringify(newOrder));

localStorage.removeItem("cart");

loadCart();

window.location.href="success.html";

}

loadMenu();
loadCart();

</script>

</body>
</html>